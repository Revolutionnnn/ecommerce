(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[473],{6960:(e,a,s)=>{Promise.resolve().then(s.bind(s,8523))},8523:(e,a,s)=>{"use strict";s.r(a),s.d(a,{default:()=>C});var t=s(5155),r=s(2115),l=s(5236),n=s(285),d=s(7311),c=s(8796),o=s(8684),i=s(7317),m=s(2997),h=s(3391),x=s(3535),p=s.n(x),u=s(6046);let j=e=>{let{steps:a,activeStep:s}=e;return(0,t.jsx)("div",{className:"flex items-center justify-between mb-8",children:a.map((e,r)=>(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center ".concat(s>=r?"bg-green-500":"bg-gray-300"," text-white"),children:r+1}),r<a.length-1&&(0,t.jsx)("div",{className:"w-12 h-1 bg-gray-300 mx-2",children:(0,t.jsx)("div",{className:"h-1 ".concat(s>r?"bg-green-500":"bg-gray-300")})})]},r))})},g=e=>{let{customerInfo:a,setCustomerInfo:s,errors:r}=e;return(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-lg font-bold mt-8 mb-4",children:"Informaci\xf3n del Cliente"}),(0,t.jsxs)("div",{className:"grid gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("input",{className:"border rounded px-3 py-2 w-full",name:"name",placeholder:"Nombre completo",type:"text",value:a.name,onChange:e=>s({...a,name:e.target.value})}),r.name&&(0,t.jsx)("p",{className:"text-red-500 text-sm",children:r.name})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("input",{className:"border rounded px-3 py-2 w-full",name:"address",placeholder:"Direcci\xf3n",type:"text",value:a.address,onChange:e=>s({...a,address:e.target.value})}),r.address&&(0,t.jsx)("p",{className:"text-red-500 text-sm",children:r.address})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("input",{className:"border rounded px-3 py-2 w-full",name:"phone",placeholder:"Tel\xe9fono",type:"text",value:a.phone,onChange:e=>s({...a,phone:e.target.value})}),r.phone&&(0,t.jsx)("p",{className:"text-red-500 text-sm",children:r.phone})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("input",{className:"border rounded px-3 py-2 w-full",name:"email",placeholder:"Correo electr\xf3nico",type:"email",value:a.email,onChange:e=>s({...a,email:e.target.value})}),r.email&&(0,t.jsx)("p",{className:"text-red-500 text-sm",children:r.email})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("select",{className:"border rounded px-3 py-2 w-full",name:"paymentMethod",value:a.paymentMethod,onChange:e=>s({...a,paymentMethod:e.target.value}),children:(0,t.jsx)("option",{value:"creditCard",children:"Tarjeta de cr\xe9dito"})}),r.paymentMethod&&(0,t.jsx)("p",{className:"text-red-500 text-sm",children:r.paymentMethod})]})]})]})},v=e=>{let{cardInfo:a,setCardInfo:s,errors:r,cardType:l,handleCardNumberChange:n}=e;return(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-lg font-bold mb-4",children:"M\xe9todo de Pago"}),(0,t.jsxs)("div",{className:"grid gap-4",children:[(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("input",{className:"border rounded px-3 py-2 w-full",placeholder:"N\xfamero de Tarjeta",type:"text",value:a.number,onChange:e=>n(e.target.value)}),r.number&&(0,t.jsx)("p",{className:"text-red-500 text-sm",children:r.number}),(0,t.jsxs)("div",{className:"absolute top-1/2 right-3 transform -translate-y-1/2",children:["visa"===l&&(0,t.jsx)("img",{alt:"Visa",className:"w-10 h-6",src:"visa.png"}),"mastercard"===l&&(0,t.jsx)("img",{alt:"Mastercard",className:"w-10 h-6",src:"mastercard.png"})]})]}),(0,t.jsxs)("div",{className:"flex gap-4",children:[(0,t.jsxs)("div",{className:"w-1/2",children:[(0,t.jsx)("input",{className:"border rounded px-3 py-2 w-full",placeholder:"Mes de Expiraci\xf3n (MM)",type:"text",value:a.expMonth,onChange:e=>s({...a,expMonth:e.target.value})}),r.expMonth&&(0,t.jsx)("p",{className:"text-red-500 text-sm",children:r.expMonth})]}),(0,t.jsxs)("div",{className:"w-1/2",children:[(0,t.jsx)("input",{className:"border rounded px-3 py-2 w-full",placeholder:"A\xf1o de Expiraci\xf3n (YY)",type:"text",value:a.expYear,onChange:e=>s({...a,expYear:e.target.value})}),r.expYear&&(0,t.jsx)("p",{className:"text-red-500 text-sm",children:r.expYear})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("input",{className:"border rounded px-3 py-2 w-full",placeholder:"CVC",type:"text",value:a.cvc,onChange:e=>s({...a,cvc:e.target.value})}),r.cvc&&(0,t.jsx)("p",{className:"text-red-500 text-sm",children:r.cvc})]}),(0,t.jsxs)("div",{className:"mt-4",children:[(0,t.jsx)("label",{htmlFor:"installments",className:"block text-sm font-medium mb-2",children:"N\xfamero de cuotas"}),(0,t.jsx)("select",{id:"installments",value:a.installments||1,onChange:e=>{s({...a,installments:Number(e.target.value)})},className:"border rounded px-3 py-2 w-full",children:[1,3,6,12].map(e=>(0,t.jsxs)("option",{value:e,children:[e," cuotas"]},e))})]})]})]})},y=e=>{let{customerInfo:a,total:s}=e,r=s+1e4;return(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-lg font-bold mb-4",children:"Confirmaci\xf3n"}),(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{children:"Nombre:"})," ",a.name]}),(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{children:"Direcci\xf3n:"})," ",a.address]}),(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{children:"Tel\xe9fono:"})," ",a.phone]}),(0,t.jsxs)("div",{className:"mt-4",children:[(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{children:"Subtotal:"})," $",s.toFixed(2)]}),(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{children:"Costo de env\xedo:"})," $","10000.00"]}),(0,t.jsxs)("p",{className:"mt-2",children:[(0,t.jsx)("strong",{children:"Total:"})," $",r.toFixed(2)]})]})]})};var b=s(4440);async function N(e){let a="".concat(b.A.baseUrl,"/payments");try{if((await fetch(a,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).ok)return{success:!0,message:"Compra realizada con \xe9xito!"};return{success:!1,message:"Hubo un problema al procesar la compra."}}catch(e){return{success:!1,message:"Hubo un problema con la conexi\xf3n al servidor."}}}var f=s(891);function C(){let e=(0,h.d4)(e=>e.cart.items),a=(0,u.useRouter)(),s=(0,h.wA)(),x=["Productos y Datos","M\xe9todo de Pago","Confirmaci\xf3n"],[b,C]=(0,r.useState)(0),[w,P]=(0,r.useState)({}),[M,S]=(0,r.useState)({name:"",address:"",phone:"",email:"",paymentMethod:"creditCard"}),[T,k]=(0,r.useState)({number:"",expMonth:"",expYear:"",cvc:"",installments:1}),[I,E]=(0,r.useState)(null),{isOpen:_,onOpen:Y,onOpenChange:A}=(0,n.j)(),[O,F]=(0,r.useState)("Pendiente..."),[q,U]=(0,r.useState)(!1),[$,D]=(0,r.useState)(!1),z=e.reduce((e,a)=>e+a.quantity*a.price,0),H=async()=>{let t=!1,r={};if((!M.name||M.name.length<1||M.name.length>50)&&(r.name="El nombre debe tener entre 1 y 50 caracteres.",t=!0),(!M.address||M.address.length<1||M.address.length>50)&&(r.address="La direcci\xf3n debe tener entre 1 y 50 caracteres.",t=!0),(!/^\d+$/.test(M.phone)||M.phone.length<7||M.phone.length>15)&&(r.phone="El tel\xe9fono debe ser un n\xfamero y tener entre 7 y 15 d\xedgitos.",t=!0),(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(M.email)||M.email.length>50)&&(r.email="Por favor ingrese un correo electr\xf3nico v\xe1lido.",t=!0),M.paymentMethod||(r.paymentMethod="Por favor seleccione un m\xe9todo de pago.",t=!0),t){P(r);return}if(b===x.length-1){if(!q||!$){P({...w,privacyPolicy:"Debe aceptar la Pol\xedtica de Privacidad y los T\xe9rminos y Condiciones."});return}Y(),F("Procesando compra...");try{let t=e.map(e=>({id:e.id,quantity:e.quantity})),r={number:T.number,expMonth:T.expMonth,expYear:T.expYear,cvc:T.cvc,installments:T.installments,customerInfo:{name:M.name,address:M.address,phone:M.phone,email:M.email||"correo@example.com"},cartItems:t,total:z},l=await N(r);F(l.message),l.success&&(s((0,f.sX)()),setTimeout(()=>{a.push("/")},2e3))}catch(e){F("Hubo un problema inesperado.")}return}P({}),C(e=>e+1)};return(0,t.jsxs)("div",{className:"max-w-4xl mx-auto py-8 px-4",children:[(0,t.jsx)("h1",{className:"text-2xl font-bold mb-6 text-center",children:"Proceso de Compra"}),(0,t.jsx)(j,{activeStep:b,steps:x}),(0,t.jsxs)("div",{className:"mt-8",children:[0===b&&(0,t.jsx)(g,{customerInfo:M,errors:w,setCustomerInfo:S}),1===b&&(0,t.jsx)(v,{cardInfo:T,cardType:I,errors:w,handleCardNumberChange:e=>{var a;k({...T,number:e});let s=p().number(e);s.isValid?P({...w,cardNumber:null}):P({...w,cardNumber:"N\xfamero de tarjeta no v\xe1lido."}),E((null===(a=s.card)||void 0===a?void 0:a.type)||null)},setCardInfo:k}),2===b&&(0,t.jsx)(y,{customerInfo:M,total:z})]}),b===x.length-1&&(0,t.jsxs)("div",{className:"mt-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("input",{checked:q,id:"privacyPolicy",type:"checkbox",onChange:e=>U(e.target.checked)}),(0,t.jsx)("label",{className:"text-sm",htmlFor:"privacyPolicy",children:(0,t.jsx)("a",{className:"text-blue-500",href:"https://wompi.com/assets/downloadble/autorizacion-administracion-datos-personales.pdf",rel:"noreferrer",target:"_blank",children:"I authorize the handling of my personal data. Read our Privacy Policy."})})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:[(0,t.jsx)("input",{checked:$,id:"termsAndConditions",type:"checkbox",onChange:e=>D(e.target.checked)}),(0,t.jsx)("label",{className:"text-sm",htmlFor:"termsAndConditions",children:(0,t.jsx)("a",{className:"text-blue-500",href:"https://wompi.com/assets/downloadble/reglamento-Usuarios-Colombia.pdf",rel:"noreferrer",target:"_blank",children:"I accept the Terms and Conditions."})})]}),w.privacyPolicy&&(0,t.jsx)("p",{className:"text-red-500 text-sm mt-2",children:w.privacyPolicy})]}),(0,t.jsxs)("div",{className:"flex justify-between mt-6",children:[(0,t.jsx)(l.T,{color:"primary",disabled:0===b,variant:"flat",onPress:()=>{C(e=>e>0?e-1:e)},children:"Atr\xe1s"}),(0,t.jsx)(l.T,{color:"success",disabled:!$||!q,variant:"shadow",onPress:H,children:b===x.length-1?"Confirmar Compra":"Siguiente"})]}),(0,t.jsx)(d.Y,{isOpen:_,onOpenChange:A,children:(0,t.jsx)(c.g,{children:e=>(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(o.c,{className:"flex flex-col gap-1",children:O.includes("\xe9xito")?"\xc9xito":"Procesando"}),(0,t.jsx)(i.h,{children:(0,t.jsx)("p",{children:O})}),(0,t.jsx)(m.q,{children:(0,t.jsx)(l.T,{color:"danger",variant:"light",onPress:e,children:"Cerrar"})})]})})})]})}},4440:(e,a,s)=>{"use strict";s.d(a,{A:()=>t});let t={baseUrl:s(2818).env.NEXT_PUBLIC_API_URL||"http://localhost:3000"}},891:(e,a,s)=>{"use strict";s.d(a,{Ay:()=>i,bE:()=>d,dt:()=>c,sX:()=>o});var t=s(8943);let r=e=>{try{let a=JSON.stringify(e);localStorage.setItem("cart",a)}catch(e){console.error("Error guardando el estado del carrito en localStorage:",e)}},l=(()=>{try{let e=localStorage.getItem("cart");if(null===e)return{items:[]};return JSON.parse(e)}catch(e){return console.error("Error cargando el estado del carrito desde localStorage:",e),{items:[]}}})(),n=(0,t.Z0)({name:"cart",initialState:l,reducers:{addToCart:(e,a)=>{let s=e.items.find(e=>e.id===a.payload.id);s?s.quantity+=a.payload.quantity:e.items.push(a.payload),r(e)},removeFromCart:(e,a)=>{e.items=e.items.filter(e=>e.id!==a.payload),r(e)},clearCart:e=>{e.items=[],r(e)}}}),{addToCart:d,removeFromCart:c,clearCart:o}=n.actions,i=n.reducer}},e=>{var a=a=>e(e.s=a);e.O(0,[1,505,236,562,382,441,517,358],()=>a(6960)),_N_E=e.O()}]);